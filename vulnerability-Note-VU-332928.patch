From 9858d774c09ae4226595e51bb243e98e28d4039d Mon Sep 17 00:00:00 2001
From: Victor Rodriguez <victor.rodriguez.bahena@intel.com>
Date: Thu, 23 Aug 2018 18:12:18 +0000
Subject: [PATCH] Add warning for Vulnerability Note VU#332928

Ghostscript contains an optional -dSAFER option, which is supposed to
prevent unsafe PostScript operations. Multiple PostScript operations
bypass the protections provided by -dSAFER, which can allow an attacker
to execute arbitrary commands with arbitrary arguments. This
vulnerability can also be exploited in applications that leverage
Ghostscript, such as ImageMagick, GraphicsMagick, evince, Okular,
Nautilus, and others.

Signed-off-by: Victor Rodriguez <victor.rodriguez.bahena@intel.com>
---
 config/policy.xml | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/config/policy.xml b/config/policy.xml
index 0d85426..87e37ff 100644
--- a/config/policy.xml
+++ b/config/policy.xml
@@ -50,6 +50,23 @@
     <policy domain="filter" rights="none" pattern="*" />
     <policy domain="coder" rights="none" pattern="*" />
     <policy domain="coder" rights="read|write" pattern="{GIF,JPEG,PNG,WEBP}" />
+
+    WARNING: Vulnerability Note VU#332928 for Ghostscript use , it contains
+    multiple -dSAFER sandbox bypass vulnerabilities:
+    https://www.kb.cert.org/vuls/id/332928
+
+    ImageMagick uses Ghostscript by default to process PostScript content.
+    ImageMagick can be controlled via the policy.xml security policy to disable
+    the processing of PS, EPS, PDF, and XPS content. For example, this can be
+    done by adding these lines to the <policymap> section of the policy.xml file
+
+    <policy domain="coder" rights="none" pattern="PS" />
+    <policy domain="coder" rights="none" pattern="PS2" />
+    <policy domain="coder" rights="none" pattern="PS3" />
+    <policy domain="coder" rights="none" pattern="EPS" />
+    <policy domain="coder" rights="none" pattern="PDF" />
+    <policy domain="coder" rights="none" pattern="XPS" />
+
 -->
 <policymap>
   <!-- <policy domain="system" name="shred" value="2"/> -->
-- 
2.18.0

